(function(){this.$jit=function(V){V=V||window;for(var W in $jit){if($jit[W].$extend){V[W]=$jit[W]}}};$jit.version="2.0.1";var C=function(V){return document.getElementById(V)};C.empty=function(){};C.extend=function(X,V){for(var W in (V||{})){X[W]=V[W]}return X};C.lambda=function(V){return(typeof V=="function")?V:function(){return V}};C.time=Date.now||function(){return +new Date};C.splat=function(W){var V=C.type(W);return V?((V!="array")?[W]:W):[]};C.type=function(W){var V=C.type.s.call(W).match(/^\[object\s(.*)\]$/)[1].toLowerCase();if(V!="object"){return V}if(W&&W.$$family){return W.$$family}if(W&&W.nodeType==9){return"htmldocument"}return(W&&W.nodeName&&W.nodeType==1)?"element":V};C.type.s=Object.prototype.toString;C.each=function(a,Z){var Y=C.type(a);if(Y=="object"){for(var X in a){Z(a[X],X)}}else{for(var W=0,V=a.length;W<V;W++){Z(a[W],W)}}};C.indexOf=function(Y,X){if(Y.indexOf){return Y.indexOf(X)}for(var W=0,V=Y.length;W<V;W++){if(Y[W]===X){return W}}return -1};C.map=function(X,W){var V=[];C.each(X,function(Z,Y){V.push(W(Z,Y))});return V};C.reduce=function(Z,X,W){var V=Z.length;if(V==0){return W}var Y=arguments.length==3?W:Z[--V];while(V--){Y=X(Y,Z[V])}return Y};C.merge=function(){var Z={};for(var Y=0,V=arguments.length;Y<V;Y++){var W=arguments[Y];if(C.type(W)!="object"){continue}for(var X in W){var b=W[X],a=Z[X];Z[X]=(a&&C.type(b)=="object"&&C.type(a)=="object")?C.merge(a,b):C.unlink(b)}}return Z};C.unlink=function(X){var W;switch(C.type(X)){case"object":W={};for(var Z in X){W[Z]=C.unlink(X[Z])}break;case"array":W=[];for(var Y=0,V=X.length;Y<V;Y++){W[Y]=C.unlink(X[Y])}break;default:return X}return W};C.zip=function(){if(arguments.length===0){return[]}for(var X=0,W=[],V=arguments.length,a=arguments[0].length;X<a;X++){for(var Y=0,Z=[];Y<V;Y++){Z.push(arguments[Y][X])}W.push(Z)}return W};C.rgbToHex=function(Z,Y){if(Z.length<3){return null}if(Z.length==4&&Z[3]==0&&!Y){return"transparent"}var W=[];for(var V=0;V<3;V++){var X=(Z[V]-0).toString(16);W.push(X.length==1?"0"+X:X)}return Y?W:"#"+W.join("")};C.hexToRgb=function(X){if(X.length!=7){X=X.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);X.shift();if(X.length!=3){return null}var V=[];for(var W=0;W<3;W++){var Y=X[W];if(Y.length==1){Y+=Y}V.push(parseInt(Y,16))}return V}else{X=parseInt(X.slice(1),16);return[X>>16,X>>8&255,X&255]}};C.destroy=function(V){C.clean(V);if(V.parentNode){V.parentNode.removeChild(V)}if(V.clearAttributes){V.clearAttributes()}};C.clean=function(Y){for(var X=Y.childNodes,W=0,V=X.length;W<V;W++){C.destroy(X[W])}};C.addEvent=function(X,W,V){if(X.addEventListener){X.addEventListener(W,V,false)}else{X.attachEvent("on"+W,V)}};C.addEvents=function(W,X){for(var V in X){C.addEvent(W,V,X[V])}};C.hasClass=function(W,V){return(" "+W.className+" ").indexOf(" "+V+" ")>-1};C.addClass=function(W,V){if(!C.hasClass(W,V)){W.className=(W.className+" "+V)}};C.removeClass=function(W,V){W.className=W.className.replace(new RegExp("(^|\\s)"+V+"(?:\\s|$)"),"$1")};C.getPos=function(X){var a=Z(X);var V=Y(X);return{x:a.x-V.x,y:a.y-V.y};function Z(c){var b={x:0,y:0};while(c&&!W(c)){b.x+=c.offsetLeft;b.y+=c.offsetTop;c=c.offsetParent}return b}function Y(c){var b={x:0,y:0};while(c&&!W(c)){b.x+=c.scrollLeft;b.y+=c.scrollTop;c=c.parentNode}return b}function W(b){return(/^(?:body|html)$/i).test(b.tagName)}};C.event={get:function(W,V){V=V||window;return W||V.event},getWheel:function(V){return V.wheelDelta?V.wheelDelta/120:-(V.detail||0)/3},isRightClick:function(V){return(V.which==3||V.button==2)},getPos:function(Y,X){X=X||window;Y=Y||X.event;var W=X.document;W=W.documentElement||W.body;if(Y.touches&&Y.touches.length){Y=Y.touches[0]}var V={x:Y.pageX||(Y.clientX+W.scrollLeft),y:Y.pageY||(Y.clientY+W.scrollTop)};return V},stop:function(V){if(V.stopPropagation){V.stopPropagation()}V.cancelBubble=true;if(V.preventDefault){V.preventDefault()}else{V.returnValue=false}}};$jit.util=$jit.id=C;var Q=function(W){W=W||{};var V=function(){for(var Z in this){if(typeof this[Z]!="function"){this[Z]=C.unlink(this[Z])}}this.constructor=V;if(Q.prototyping){return this}var Y=this.initialize?this.initialize.apply(this,arguments):this;this.$$family="class";return Y};for(var X in Q.Mutators){if(!W[X]){continue}W=Q.Mutators[X](W,W[X]);delete W[X]}C.extend(V,this);V.constructor=Q;V.prototype=W;return V};Q.Mutators={Implements:function(V,W){C.each(C.splat(W),function(Y){Q.prototyping=Y;var X=(typeof Y=="function")?new Y:Y;for(var Z in X){if(!(Z in V)){V[Z]=X[Z]}}delete Q.prototyping});return V}};C.extend(Q,{inherit:function(V,Y){for(var X in Y){var W=Y[X];var a=V[X];var Z=C.type(W);if(a&&Z=="function"){if(W!=a){Q.override(V,X,W)}}else{if(Z=="object"){V[X]=C.merge(a,W)}else{V[X]=W}}}return V},override:function(W,V,Z){var Y=Q.prototyping;if(Y&&W[V]!=Y[V]){Y=null}var X=function(){var a=this.parent;this.parent=Y?Y[V]:W[V];var b=Z.apply(this,arguments);this.parent=a;return b};W[V]=X}});Q.prototype.implement=function(){var V=this.prototype;C.each(Array.prototype.slice.call(arguments||[]),function(W){Q.inherit(V,W)});return this};$jit.Class=Q;$jit.json={prune:function(W,V){this.each(W,function(Y,X){if(X==V&&Y.children){delete Y.children;Y.children=[]}})},getParent:function(V,Z){if(V.id==Z){return false}var Y=V.children;if(Y&&Y.length>0){for(var X=0;X<Y.length;X++){if(Y[X].id==Z){return V}else{var W=this.getParent(Y[X],Z);if(W){return W}}}}return false},getSubtree:function(V,Z){if(V.id==Z){return V}for(var X=0,Y=V.children;Y&&X<Y.length;X++){var W=this.getSubtree(Y[X],Z);if(W!=null){return W}}return null},eachLevel:function(V,a,X,Z){if(a<=X){Z(V,a);if(!V.children){return}for(var W=0,Y=V.children;W<Y.length;W++){this.eachLevel(Y[W],a+1,X,Z)}}},each:function(V,W){this.eachLevel(V,0,Number.MAX_VALUE,W)}};$jit.Trans={$extend:true,linear:function(V){return V}};var I=$jit.Trans;(function(){var V=function(Y,X){X=C.splat(X);return C.extend(Y,{easeIn:function(Z){return Y(Z,X)},easeOut:function(Z){return 1-Y(1-Z,X)},easeInOut:function(Z){return(Z<=0.5)?Y(2*Z,X)/2:(2-Y(2*(1-Z),X))/2}})};var W={Pow:function(Y,X){return Math.pow(Y,X[0]||6)},Expo:function(X){return Math.pow(2,8*(X-1))},Circ:function(X){return 1-Math.sin(Math.acos(X))},Sine:function(X){return 1-Math.sin((1-X)*Math.PI/2)},Back:function(Y,X){X=X[0]||1.618;return Math.pow(Y,2)*((X+1)*Y-X)},Bounce:function(c){var Z;for(var Y=0,X=1;1;Y+=X,X/=2){if(c>=(7-4*Y)/11){Z=X*X-Math.pow((11-6*Y-11*c)/4,2);break}}return Z},Elastic:function(Y,X){return Math.pow(2,10*--Y)*Math.cos(20*Y*Math.PI*(X[0]||1)/3)}};C.each(W,function(Y,X){I[X]=V(Y)});C.each(["Quad","Cubic","Quart","Quint"],function(Y,X){I[Y]=V(function(Z){return Math.pow(Z,[X+2])})})})();var U=new Q({initialize:function(V){this.setOptions(V)},setOptions:function(V){var W={duration:2500,fps:40,transition:I.Quart.easeInOut,compute:C.empty,complete:C.empty,link:"ignore"};this.opt=C.merge(W,V||{});return this},step:function(){var W=C.time(),V=this.opt;if(W<this.time+V.duration){var X=V.transition((W-this.time)/V.duration);V.compute(X)}else{this.timer=clearInterval(this.timer);V.compute(1);V.complete()}},start:function(){if(!this.check()){return this}this.time=0;this.startTimer();return this},startTimer:function(){var V=this,W=this.opt.fps;if(this.timer){return false}this.time=C.time()-this.time;this.timer=setInterval((function(){V.step()}),Math.round(1000/W));return true},pause:function(){this.stopTimer();return this},resume:function(){this.startTimer();return this},stopTimer:function(){if(!this.timer){return false}this.time=C.time()-this.time;this.timer=clearInterval(this.timer);return true},check:function(){if(!this.timer){return true}if(this.opt.link=="cancel"){this.stopTimer();return true}return false}});var N=function(){var X=arguments;for(var Z=0,V=X.length,W={};Z<V;Z++){var Y=N[X[Z]];if(Y.$extend){C.extend(W,Y)}else{W[X[Z]]=Y}}return W};N.Canvas={$extend:true,injectInto:"id",type:"2D",width:false,height:false,useCanvas:false,withLabels:true,background:false,Scene:{Lighting:{enable:false,ambient:[1,1,1],directional:{direction:{x:-100,y:-100,z:-100},color:[0.5,0.3,0.1]}}}};N.Node={$extend:false,overridable:false,type:"circle",color:"#ccb",alpha:1,dim:3,height:20,width:90,autoHeight:false,autoWidth:false,lineWidth:1,transform:true,align:"center",angularWidth:1,span:1,CanvasStyles:{}};N.Edge={$extend:false,overridable:false,type:"line",color:"#ccb",lineWidth:1,dim:15,alpha:1,epsilon:7,CanvasStyles:{}};N.Fx={$extend:true,fps:40,duration:2500,transition:$jit.Trans.Quart.easeInOut,clearCanvas:true};N.Label={$extend:false,overridable:false,type:"HTML",style:" ",size:10,family:"sans-serif",textAlign:"center",textBaseline:"alphabetic",color:"#fff"};N.Tips={$extend:false,enable:false,type:"auto",offsetX:20,offsetY:20,force:false,onShow:C.empty,onHide:C.empty};N.NodeStyles={$extend:false,enable:false,type:"auto",stylesHover:false,stylesClick:false};N.Events={$extend:false,enable:false,enableForEdges:false,type:"auto",onClick:C.empty,onRightClick:C.empty,onMouseMove:C.empty,onMouseEnter:C.empty,onMouseLeave:C.empty,onDragStart:C.empty,onDragMove:C.empty,onDragCancel:C.empty,onDragEnd:C.empty,onTouchStart:C.empty,onTouchMove:C.empty,onTouchEnd:C.empty,onMouseWheel:C.empty};N.Navigation={$extend:false,enable:false,type:"auto",panning:false,zooming:false};N.Controller={$extend:true,onBeforeCompute:C.empty,onAfterCompute:C.empty,onCreateLabel:C.empty,onPlaceLabel:C.empty,onComplete:C.empty,onBeforePlotLine:C.empty,onAfterPlotLine:C.empty,onBeforePlotNode:C.empty,onAfterPlotNode:C.empty,onBeforeRemoveNode:C.empty,request:false};var T={initialize:function(X,V){this.viz=V;this.canvas=V.canvas;this.config=V.config[X];this.nodeTypes=V.fx.nodeTypes;var W=this.config.type;this.dom=W=="auto"?(V.config.Label.type!="Native"):(W!="Native");this.labelContainer=this.dom&&V.labels.getLabelContainer();this.isEnabled()&&this.initializePost()},initializePost:C.empty,setAsProperty:C.lambda(false),isEnabled:function(){return this.config.enable},isLabel:function(a,Z,Y){a=C.event.get(a,Z);var V=this.labelContainer,X=a.target||a.srcElement,W=a.relatedTarget;if(Y){return W&&W==this.viz.canvas.getCtx().canvas&&!!X&&this.isDescendantOf(X,V)}else{return this.isDescendantOf(X,V)}},isDescendantOf:function(W,V){while(W&&W.parentNode){if(W.parentNode==V){return W}W=W.parentNode}return false}};var H={onMouseUp:C.empty,onMouseDown:C.empty,onMouseMove:C.empty,onMouseOver:C.empty,onMouseOut:C.empty,onMouseWheel:C.empty,onTouchStart:C.empty,onTouchMove:C.empty,onTouchEnd:C.empty,onTouchCancel:C.empty};var S=new Q({initialize:function(V){this.viz=V;this.canvas=V.canvas;this.node=false;this.edge=false;this.registeredObjects=[];this.attachEvents()},attachEvents:function(){var X=this.canvas.getElement(),W=this;X.oncontextmenu=C.lambda(false);C.addEvents(X,{mouseup:function(a,Z){var Y=C.event.get(a,Z);W.handleEvent("MouseUp",a,Z,W.makeEventObject(a,Z),C.event.isRightClick(Y))},mousedown:function(a,Z){var Y=C.event.get(a,Z);W.handleEvent("MouseDown",a,Z,W.makeEventObject(a,Z),C.event.isRightClick(Y))},mousemove:function(Z,Y){W.handleEvent("MouseMove",Z,Y,W.makeEventObject(Z,Y))},mouseover:function(Z,Y){W.handleEvent("MouseOver",Z,Y,W.makeEventObject(Z,Y))},mouseout:function(Z,Y){W.handleEvent("MouseOut",Z,Y,W.makeEventObject(Z,Y))},touchstart:function(Z,Y){W.handleEvent("TouchStart",Z,Y,W.makeEventObject(Z,Y))},touchmove:function(Z,Y){W.handleEvent("TouchMove",Z,Y,W.makeEventObject(Z,Y))},touchend:function(Z,Y){W.handleEvent("TouchEnd",Z,Y,W.makeEventObject(Z,Y))}});var V=function(b,a){var Z=C.event.get(b,a);var Y=C.event.getWheel(Z);W.handleEvent("MouseWheel",b,a,Y)};if(!document.getBoxObjectFor&&window.mozInnerScreenX==null){C.addEvent(X,"mousewheel",V)}else{X.addEventListener("DOMMouseScroll",V,false)}},register:function(V){this.registeredObjects.push(V)},handleEvent:function(){var W=Array.prototype.slice.call(arguments),Z=W.shift();for(var Y=0,X=this.registeredObjects,V=X.length;Y<V;Y++){X[Y]["on"+Z].apply(X[Y],W)}},makeEventObject:function(b,a){var Y=this,Z=this.viz.graph,X=this.viz.fx,W=X.nodeTypes,V=X.edgeTypes;return{pos:false,node:false,edge:false,contains:false,getNodeCalled:false,getEdgeCalled:false,getPos:function(){var e=Y.viz.canvas,f=e.getSize(),g=e.getPos(),d=e.translateOffsetX,c=e.translateOffsetY,j=e.scaleOffsetX,h=e.scaleOffsetY,i=C.event.getPos(b,a);this.pos={x:(i.x-g.x-f.width/2-d)*1/j,y:(i.y-g.y-f.height/2-c)*1/h};return this.pos},getNode:function(){if(this.getNodeCalled){return this.node}this.getNodeCalled=true;for(var f in Z.nodes){var e=Z.nodes[f],d=e&&W[e.getData("type")],c=d&&d.contains&&d.contains.call(X,e,this.getPos());if(c){this.contains=c;return Y.node=this.node=e}}return Y.node=this.node=false},getEdge:function(){if(this.getEdgeCalled){return this.edge}this.getEdgeCalled=true;var f={};for(var j in Z.edges){var h=Z.edges[j];f[j]=true;for(var i in h){if(i in f){continue}var g=h[i],d=g&&V[g.getData("type")],c=d&&d.contains&&d.contains.call(X,g,this.getPos());if(c){this.contains=c;return Y.edge=this.edge=g}}}return Y.edge=this.edge=false},getContains:function(){if(this.getNodeCalled){return this.contains}this.getNode();return this.contains}}}});var O={initializeExtras:function(){var W=new S(this),V=this;C.each(["NodeStyles","Tips","Navigation","Events"],function(X){var Y=new O.Classes[X](X,V);if(Y.isEnabled()){W.register(Y)}if(Y.setAsProperty()){V[X.toLowerCase()]=Y}})}};O.Classes={};O.Classes.Events=new Q({Implements:[T,H],initializePost:function(){this.fx=this.viz.fx;this.ntypes=this.viz.fx.nodeTypes;this.etypes=this.viz.fx.edgeTypes;this.hovered=false;this.pressed=false;this.touched=false;this.touchMoved=false;this.moved=false},setAsProperty:C.lambda(true),onMouseUp:function(Z,Y,W,X){var V=C.event.get(Z,Y);if(!this.moved){if(X){this.config.onRightClick(this.hovered,W,V)}else{this.config.onClick(this.pressed,W,V)}}if(this.pressed){if(this.moved){this.config.onDragEnd(this.pressed,W,V)}else{this.config.onDragCancel(this.pressed,W,V)}this.pressed=this.moved=false}},onMouseOut:function(a,Z,Y){var W=C.event.get(a,Z),X;if(this.dom&&(X=this.isLabel(a,Z,true))){this.config.onMouseLeave(this.viz.graph.getNode(X.id),Y,W);this.hovered=false;return}var V=W.relatedTarget,b=this.canvas.getElement();while(V&&V.parentNode){if(b==V.parentNode){return}V=V.parentNode}if(this.hovered){this.config.onMouseLeave(this.hovered,Y,W);this.hovered=false}},onMouseOver:function(Z,Y,X){var V=C.event.get(Z,Y),W;if(this.dom&&(W=this.isLabel(Z,Y,true))){this.hovered=this.viz.graph.getNode(W.id);this.config.onMouseEnter(this.hovered,X,V)}},onMouseMove:function(b,a,Z){var W,V=C.event.get(b,a);if(this.pressed){this.moved=true;this.config.onDragMove(this.pressed,Z,V);return}if(this.dom){this.config.onMouseMove(this.hovered,Z,V)}else{if(this.hovered){var c=this.hovered;var Y=c.nodeFrom?this.etypes[c.getData("type")]:this.ntypes[c.getData("type")];var X=Y&&Y.contains&&Y.contains.call(this.fx,c,Z.getPos());if(X){this.config.onMouseMove(c,Z,V);return}else{this.config.onMouseLeave(c,Z,V);this.hovered=false}}if(this.hovered=(Z.getNode()||(this.config.enableForEdges&&Z.getEdge()))){this.config.onMouseEnter(this.hovered,Z,V)}else{this.config.onMouseMove(false,Z,V)}}},onMouseWheel:function(W,V,X){this.config.onMouseWheel(X,C.event.get(W,V))},onMouseDown:function(Z,Y,X){var V=C.event.get(Z,Y),W;if(this.dom){if(W=this.isLabel(Z,Y)){this.pressed=this.viz.graph.getNode(W.id)}}else{this.pressed=X.getNode()||(this.config.enableForEdges&&X.getEdge())}this.pressed&&this.config.onDragStart(this.pressed,X,V)},onTouchStart:function(Z,Y,X){var V=C.event.get(Z,Y),W;if(this.dom&&(W=this.isLabel(Z,Y))){this.touched=this.viz.graph.getNode(W.id)}else{this.touched=X.getNode()||(this.config.enableForEdges&&X.getEdge())}this.touched&&this.config.onTouchStart(this.touched,X,V)},onTouchMove:function(Y,X,W){var V=C.event.get(Y,X);if(this.touched){this.touchMoved=true;this.config.onTouchMove(this.touched,W,V)}},onTouchEnd:function(Y,X,W){var V=C.event.get(Y,X);if(this.touched){if(this.touchMoved){this.config.onTouchEnd(this.touched,W,V)}else{this.config.onTouchCancel(this.touched,W,V)}this.touched=this.touchMoved=false}}});O.Classes.Tips=new Q({Implements:[T,H],initializePost:function(){if(document.body){var V=C("_tooltip")||document.createElement("div");V.id="_tooltip";V.className="tip";C.extend(V.style,{position:"absolute",display:"none",zIndex:13000});document.body.appendChild(V);this.tip=V;this.node=false}},setAsProperty:C.lambda(true),onMouseOut:function(Y,X){var W=C.event.get(Y,X);if(this.dom&&this.isLabel(Y,X,true)){this.hide(true);return}var V=Y.relatedTarget,Z=this.canvas.getElement();while(V&&V.parentNode){if(Z==V.parentNode){return}V=V.parentNode}this.hide(false)},onMouseOver:function(X,W){var V;if(this.dom&&(V=this.isLabel(X,W,false))){this.node=this.viz.graph.getNode(V.id);this.config.onShow(this.tip,this.node,V)}},onMouseMove:function(Y,X,V){if(this.dom&&this.isLabel(Y,X)){this.setTooltipPosition(C.event.getPos(Y,X))}if(!this.dom){var W=V.getNode();if(!W){this.hide(true);return}if(this.config.force||!this.node||this.node.id!=W.id){this.node=W;this.config.onShow(this.tip,W,V.getContains())}this.setTooltipPosition(C.event.getPos(Y,X))}},setTooltipPosition:function(Z){var c=this.tip,V=c.style,d=this.config;V.display="";var W=document.compatMode==="CSS1Compat"&&document.documentElement||document.body||document.documentElement;var a={width:W.clientWidth,height:W.clientHeight,x:window.pageXOffset||document.documentElement&&document.documentElement.scrollLeft||document.body&&document.body.scrollLeft||0,y:window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop||0};var X={width:c.offsetWidth,height:c.offsetHeight};var b=d.offsetX,Y=d.offsetY;V.top=((Z.y+X.height+Y>a.height+a.y)?(Z.y-X.height-Y):Z.y+Y)+"px";V.left=((Z.x+X.width+b>a.width+a.x)?(Z.x-X.width-b):Z.x+b)+"px"},hide:function(V){this.tip.style.display="none";V&&this.config.onHide()}});O.Classes.NodeStyles=new Q({Implements:[T,H],initializePost:function(){this.fx=this.viz.fx;this.types=this.viz.fx.nodeTypes;this.nStyles=this.config;this.nodeStylesOnHover=this.nStyles.stylesHover;this.nodeStylesOnClick=this.nStyles.stylesClick;this.hoveredNode=false;this.fx.nodeFxAnimation=new U();this.down=false;this.move=false},onMouseOut:function(X,W){this.down=this.move=false;if(!this.hoveredNode){return}if(this.dom&&this.isLabel(X,W,true)){this.toggleStylesOnHover(this.hoveredNode,false)}var V=X.relatedTarget,Y=this.canvas.getElement();while(V&&V.parentNode){if(Y==V.parentNode){return}V=V.parentNode}this.toggleStylesOnHover(this.hoveredNode,false);this.hoveredNode=false},onMouseOver:function(Y,X){var V;if(this.dom&&(V=this.isLabel(Y,X,true))){var W=this.viz.graph.getNode(V.id);if(W.selected){return}this.hoveredNode=W;this.toggleStylesOnHover(this.hoveredNode,true)}},onMouseDown:function(Z,Y,W,X){if(X){return}var V;if(this.dom&&(V=this.isLabel(Z,Y))){this.down=this.viz.graph.getNode(V.id)}else{if(!this.dom){this.down=W.getNode()}}this.move=false},onMouseUp:function(Y,X,V,W){if(W){return}if(!this.move){this.onClick(V.getNode())}this.down=this.move=false},getRestoredStyles:function(W,V){var Y={},X=this["nodeStylesOn"+V];for(var Z in X){Y[Z]=W.styles["$"+Z]}return Y},toggleStylesOnHover:function(V,W){if(this.nodeStylesOnHover){this.toggleStylesOn("Hover",V,W)}},toggleStylesOnClick:function(V,W){if(this.nodeStylesOnClick){this.toggleStylesOn("Click",V,W)}},toggleStylesOn:function(Z,V,b){var c=this.viz;var a=this.nStyles;if(b){var Y=this;if(!V.styles){V.styles=C.merge(V.data,{})}for(var d in this["nodeStylesOn"+Z]){var W="$"+d;if(!(W in V.styles)){V.styles[W]=V.getData(d)}}c.fx.nodeFx(C.extend({elements:{id:V.id,properties:Y["nodeStylesOn"+Z]},transition:I.Quart.easeOut,duration:300,fps:40},this.config))}else{var X=this.getRestoredStyles(V,Z);c.fx.nodeFx(C.extend({elements:{id:V.id,properties:X},transition:I.Quart.easeOut,duration:300,fps:40},this.config))}},onClick:function(V){if(!V){return}var W=this.nodeStylesOnClick;if(!W){return}if(V.selected){this.toggleStylesOnClick(V,false);delete V.selected}else{this.viz.graph.eachNode(function(Y){if(Y.selected){for(var X in W){Y.setData(X,Y.styles["$"+X],"end")}delete Y.selected}});this.toggleStylesOnClick(V,true);V.selected=true;delete V.hovered;this.hoveredNode=false}},onMouseMove:function(b,a,Y){if(this.down){this.move=true}if(this.dom&&this.isLabel(b,a)){return}var Z=this.nodeStylesOnHover;if(!Z){return}if(!this.dom){if(this.hoveredNode){var W=this.types[this.hoveredNode.getData("type")];var V=W&&W.contains&&W.contains.call(this.fx,this.hoveredNode,Y.getPos());if(V){return}}var X=Y.getNode();if(!this.hoveredNode&&!X){return}if(X.hovered){return}if(X&&!X.selected){this.fx.nodeFxAnimation.stopTimer();this.viz.graph.eachNode(function(d){if(d.hovered&&!d.selected){for(var c in Z){d.setData(c,d.styles["$"+c],"end")}delete d.hovered}});X.hovered=true;this.hoveredNode=X;this.toggleStylesOnHover(X,true)}else{if(this.hoveredNode&&!this.hoveredNode.selected){this.fx.nodeFxAnimation.stopTimer();this.toggleStylesOnHover(this.hoveredNode,false);delete this.hoveredNode.hovered;this.hoveredNode=false}}}}});O.Classes.Navigation=new Q({Implements:[T,H],initializePost:function(){this.pos=false;this.pressed=false},onMouseWheel:function(Y,X,V){if(!this.config.zooming){return}C.event.stop(C.event.get(Y,X));var Z=this.config.zooming/1000,W=1+V*Z;this.canvas.scale(W,W)},onMouseDown:function(a,Z,Y){if(!this.config.panning){return}a.preventDefault?a.preventDefault():a.returnValue=false;C.addClass(this.canvas.getElement(),"grabbing");if(this.config.panning=="avoid nodes"&&(this.dom?this.isLabel(a,Z):(Y.getNode()||Y.getEdge()))){return}this.pressed=true;this.pos=Y.getPos();var X=this.canvas,W=X.translateOffsetX,V=X.translateOffsetY,c=X.scaleOffsetX,b=X.scaleOffsetY;this.pos.x*=c;this.pos.x+=W;this.pos.y*=b;this.pos.y+=V},onMouseMove:function(a,Z,c){if(!this.config.panning){return}if(!this.pressed){return}if(this.config.panning=="avoid nodes"&&(this.dom?this.isLabel(a,Z):c.getNode())){return}var Y=this.pos,b=c.getPos(),W=this.canvas,X=W.translateOffsetX,V=W.translateOffsetY,h=W.scaleOffsetX,f=W.scaleOffsetY;b.x*=h;b.y*=f;b.x+=X;b.y+=V;var g=b.x-Y.x,d=b.y-Y.y;this.pos=b;this.canvas.translate(g*1/h,d*1/f)},onMouseUp:function(Y,X,W,V){if(!this.config.panning){return}C.removeClass(this.canvas.getElement(),"grabbing");this.pressed=false}});var L;(function(){var V=typeof HTMLCanvasElement,X=(V=="object"||V=="function");function W(Y,Z){var a=document.createElement(Y);for(var b in Z){if(typeof Z[b]=="object"){C.extend(a[b],Z[b])}else{a[b]=Z[b]}}if(Y=="canvas"&&!X&&G_vmlCanvasManager){a=G_vmlCanvasManager.initElement(document.body.appendChild(a))}return a}$jit.Canvas=L=new Q({canvases:[],pos:false,element:false,labelContainer:false,translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(k,d){this.viz=k;this.opt=this.config=d;var a=C.type(d.injectInto)=="string"?d.injectInto:d.injectInto.id,j=d.type,b=a+"-label",Y=C(a),c=d.width||Y.offsetWidth,l=d.height||Y.offsetHeight;this.id=a;var e={injectInto:a,width:c,height:l};this.element=W("div",{id:a+"-canvaswidget",style:{position:"relative",width:c+"px",height:l+"px"}});this.labelContainer=this.createLabelContainer(d.Label.type,b,e);this.canvases.push(new L.Base[j]({config:C.extend({idSuffix:"-canvas"},e),plot:function(m){k.fx.plot()},resize:function(){k.refresh()}}));var f=d.background;if(f){var i=new L.Background[f.type](k,C.extend(f,e));this.canvases.push(new L.Base[j](i))}var h=this.canvases.length;while(h--){this.element.appendChild(this.canvases[h].canvas);if(h>0){this.canvases[h].plot()}}this.element.appendChild(this.labelContainer);Y.appendChild(this.element);var Z=null,g=this;C.addEvent(window,"scroll",function(){clearTimeout(Z);Z=setTimeout(function(){g.getPos(true)},500)})},getCtx:function(Y){return this.canvases[Y||0].getCtx()},getConfig:function(){return this.opt},getElement:function(){return this.element},getSize:function(Y){return this.canvases[Y||0].getSize()},resize:function(c,Y){this.getPos(true);this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;for(var a=0,Z=this.canvases.length;a<Z;a++){this.canvases[a].resize(c,Y)}var b=this.element.style;b.width=c+"px";b.height=Y+"px";if(this.labelContainer){this.labelContainer.style.width=c+"px"}},translate:function(Y,c,b){this.translateOffsetX+=Y*this.scaleOffsetX;this.translateOffsetY+=c*this.scaleOffsetY;for(var a=0,Z=this.canvases.length;a<Z;a++){this.canvases[a].translate(Y,c,b)}},scale:function(d,a,b){var e=this.scaleOffsetX*d,c=this.scaleOffsetY*a;var g=this.translateOffsetX*(d-1)/e,f=this.translateOffsetY*(a-1)/c;this.scaleOffsetX=e;this.scaleOffsetY=c;for(var Z=0,Y=this.canvases.length;Z<Y;Z++){this.canvases[Z].scale(d,a,true)}this.translate(g,f,false)},getZoom:function(){return new P(this.scaleOffsetX,this.scaleOffsetY)},setZoom:function(Y,d,b){var c=this.getZoom(),a=Y/c.x,Z=d/c.y;this.scale(a,Z,b)},getPos:function(Y){if(Y||!this.pos){return this.pos=C.getPos(this.getElement())}return this.pos},clear:function(Y){this.canvases[Y||0].clear()},path:function(Z,a){var Y=this.canvases[0].getCtx();Y.beginPath();a(Y);Y[Z]();Y.closePath()},createLabelContainer:function(a,e,d){var c="http://www.w3.org/2000/svg";if(a=="HTML"||a=="Native"){return W("div",{id:e,style:{overflow:"visible",position:"absolute",top:0,left:0,width:d.width+"px",height:0}})}else{if(a=="SVG"){var b=document.createElementNS(c,"svg:svg");b.setAttribute("width",d.width);b.setAttribute("height",d.height);var Z=b.style;Z.position="absolute";Z.left=Z.top="0px";var Y=document.createElementNS(c,"svg:g");Y.setAttribute("width",d.width);Y.setAttribute("height",d.height);Y.setAttribute("x",0);Y.setAttribute("y",0);Y.setAttribute("id",e);b.appendChild(Y);return b}}}});L.Base={};L.Base["2D"]=new Q({translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(Y){this.viz=Y;this.opt=Y.config;this.size=false;this.createCanvas();this.translateToCenter()},createCanvas:function(){var Z=this.opt,a=Z.width,Y=Z.height;this.canvas=W("canvas",{id:Z.injectInto+Z.idSuffix,width:a,height:Y,style:{position:"absolute",top:0,left:0,width:a+"px",height:Y+"px"}})},getCtx:function(){if(!this.ctx){return this.ctx=this.canvas.getContext("2d")}return this.ctx},getSize:function(){if(this.size){return this.size}var Y=this.canvas;return this.size={width:Y.width,height:Y.height}},translateToCenter:function(b){var Z=this.getSize(),a=b?(Z.width-b.width-this.translateOffsetX*2):Z.width;height=b?(Z.height-b.height-this.translateOffsetY*2):Z.height;var Y=this.getCtx();b&&Y.scale(1/this.scaleOffsetX,1/this.scaleOffsetY);Y.translate(a/2,height/2)},resize:function(b,Y){var a=this.getSize(),Z=this.canvas,c=Z.style;this.size=false;Z.width=b;Z.height=Y;c.width=b+"px";c.height=Y+"px";if(!X){this.translateToCenter(a)}else{this.translateToCenter()}this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;this.clear();this.viz.resize(b,Y,this)},translate:function(Y,c,Z){var b=this.scaleOffsetX,a=this.scaleOffsetY;this.translateOffsetX+=Y*b;this.translateOffsetY+=c*a;this.getCtx().translate(Y,c);!Z&&this.plot()},scale:function(Y,a,Z){this.scaleOffsetX*=Y;this.scaleOffsetY*=a;this.getCtx().scale(Y,a);!Z&&this.plot()},clear:function(){var a=this.getSize(),Z=this.translateOffsetX,Y=this.translateOffsetY,c=this.scaleOffsetX,b=this.scaleOffsetY;this.getCtx().clearRect((-a.width/2-Z)*1/c,(-a.height/2-Y)*1/b,a.width*1/c,a.height*1/b)},plot:function(){this.clear();this.viz.plot(this)}});L.Background={};L.Background.Circles=new Q({initialize:function(Y,Z){this.viz=Y;this.config=C.merge({idSuffix:"-bkcanvas",levelDistance:100,numberOfCircles:6,CanvasStyles:{},offset:0},Z)},resize:function(Z,Y,a){this.plot(a)},plot:function(Y){var Z=Y.canvas,f=Y.getCtx(),c=this.config,e=c.CanvasStyles;for(var g in e){f[g]=e[g]}var a=c.numberOfCircles,d=c.levelDistance;for(var b=1;b<=a;b++){f.beginPath();f.arc(0,0,d*b,0,2*Math.PI,false);f.stroke();f.closePath()}}})})();var B=function(W,V){this.theta=W||0;this.rho=V||0};$jit.Polar=B;B.prototype={getc:function(V){return this.toComplex(V)},getp:function(){return this},set:function(V){V=V.getp();this.theta=V.theta;this.rho=V.rho},setc:function(V,W){this.rho=Math.sqrt(V*V+W*W);this.theta=Math.atan2(W,V);if(this.theta<0){this.theta+=Math.PI*2}},setp:function(W,V){this.theta=W;this.rho=V},clone:function(){return new B(this.theta,this.rho)},toComplex:function(X){var V=Math.cos(this.theta)*this.rho;var W=Math.sin(this.theta)*this.rho;if(X){return{x:V,y:W}}return new P(V,W)},add:function(V){return new B(this.theta+V.theta,this.rho+V.rho)},scale:function(V){return new B(this.theta,this.rho*V)},equals:function(V){return this.theta==V.theta&&this.rho==V.rho},$add:function(V){this.theta=this.theta+V.theta;this.rho+=V.rho;return this},$madd:function(V){this.theta=(this.theta+V.theta)%(Math.PI*2);this.rho+=V.rho;return this},$scale:function(V){this.rho*=V;return this},isZero:function(){var W=0.0001,V=Math.abs;return V(this.theta)<W&&V(this.rho)<W},interpolate:function(X,e){var Y=Math.PI,b=Y*2;var W=function(g){var f=(g<0)?(g%b)+b:g%b;return f};var a=this.theta,d=X.theta;var Z,c=Math.abs(a-d);if(c==Y){if(a>d){Z=W((d+((a-b)-d)*e))}else{Z=W((d-b+(a-(d))*e))}}else{if(c>=Y){if(a>d){Z=W((d+((a-b)-d)*e))}else{Z=W((d-b+(a-(d-b))*e))}}else{Z=W((d+(a-d)*e))}}var V=(this.rho-X.rho)*e+X.rho;return{theta:Z,rho:V}}};var K=function(W,V){return new B(W,V)};B.KER=K(0,0);var P=function(V,W){this.x=V||0;this.y=W||0};$jit.Complex=P;P.prototype={getc:function(){return this},getp:function(V){return this.toPolar(V)},set:function(V){V=V.getc(true);this.x=V.x;this.y=V.y},setc:function(V,W){this.x=V;this.y=W},setp:function(W,V){this.x=Math.cos(W)*V;this.y=Math.sin(W)*V},clone:function(){return new P(this.x,this.y)},toPolar:function(X){var V=this.norm();var W=Math.atan2(this.y,this.x);if(W<0){W+=Math.PI*2}if(X){return{theta:W,rho:V}}return new B(W,V)},norm:function(){return Math.sqrt(this.squaredNorm())},squaredNorm:function(){return this.x*this.x+this.y*this.y},add:function(V){return new P(this.x+V.x,this.y+V.y)},prod:function(V){return new P(this.x*V.x-this.y*V.y,this.y*V.x+this.x*V.y)},conjugate:function(){return new P(this.x,-this.y)},scale:function(V){return new P(this.x*V,this.y*V)},equals:function(V){return this.x==V.x&&this.y==V.y},$add:function(V){this.x+=V.x;this.y+=V.y;return this},$prod:function(X){var V=this.x,W=this.y;this.x=V*X.x-W*X.y;this.y=W*X.x+V*X.y;return this},$conjugate:function(){this.y=-this.y;return this},$scale:function(V){this.x*=V;this.y*=V;return this},$div:function(Y){var V=this.x,X=this.y;var W=Y.squaredNorm();this.x=V*Y.x+X*Y.y;this.y=X*Y.x-V*Y.y;return this.$scale(1/W)},isZero:function(){var W=0.0001,V=Math.abs;return V(this.x)<W&&V(this.y)<W}};var R=function(W,V){return new P(W,V)};P.KER=R(0,0);P.IM=R(0,1);$jit.Graph=new Q({initialize:function(X,W,V,b){var Z={klass:P,Node:{}};this.Node=W;this.Edge=V;this.Label=b;this.opt=C.merge(Z,X||{});this.nodes={};this.edges={};var Y=this;this.nodeList={};for(var a in J){Y.nodeList[a]=(function(c){return function(){var d=Array.prototype.slice.call(arguments);Y.eachNode(function(e){e[c].apply(e,d)})}})(a)}},getNode:function(V){if(this.hasNode(V)){return this.nodes[V]}return false},get:function(V){return this.getNode(V)},getByName:function(V){for(var X in this.nodes){var W=this.nodes[X];if(W.name==V){return W}}return false},getAdjacence:function(W,V){if(W in this.edges){return this.edges[W][V]}return false},addNode:function(W){if(!this.nodes[W.id]){var V=this.edges[W.id]={};this.nodes[W.id]=new E.Node(C.extend({id:W.id,name:W.name,data:C.merge(W.data||{},{}),adjacencies:V},this.opt.Node),this.opt.klass,this.Node,this.Edge,this.Label)}return this.nodes[W.id]},addAdjacence:function(Y,X,W){if(!this.hasNode(Y.id)){this.addNode(Y)}if(!this.hasNode(X.id)){this.addNode(X)}Y=this.nodes[Y.id];X=this.nodes[X.id];if(!Y.adjacentTo(X)){var Z=this.edges[Y.id]=this.edges[Y.id]||{};var V=this.edges[X.id]=this.edges[X.id]||{};Z[X.id]=V[Y.id]=new E.Adjacence(Y,X,W,this.Edge,this.Label);return Z[X.id]}return this.edges[Y.id][X.id]},removeNode:function(X){if(this.hasNode(X)){delete this.nodes[X];var W=this.edges[X];for(var V in W){delete this.edges[V][X]}delete this.edges[X]}},removeAdjacence:function(W,V){delete this.edges[W][V];delete this.edges[V][W]},hasNode:function(V){return V in this.nodes},empty:function(){this.nodes={};this.edges={}}});var E=$jit.Graph;var J;(function(){var V=function(c,e,Z,b,d){var a;Z=Z||"current";c="$"+(c?c+"-":"");if(Z=="current"){a=this.data}else{if(Z=="start"){a=this.startData}else{if(Z=="end"){a=this.endData}}}var Y=c+e;if(b){return a[Y]}if(!this.Config.overridable){return d[e]||0}return(Y in a)?a[Y]:((Y in this.data)?this.data[Y]:(d[e]||0))};var X=function(b,c,a,Y){Y=Y||"current";b="$"+(b?b+"-":"");var Z;if(Y=="current"){Z=this.data}else{if(Y=="start"){Z=this.startData}else{if(Y=="end"){Z=this.endData}}}Z[b+c]=a};var W=function(a,Y){a="$"+(a?a+"-":"");var Z=this;C.each(Y,function(c){var b=a+c;delete Z.data[b];delete Z.endData[b];delete Z.startData[b]})};J={getData:function(a,Y,Z){return V.call(this,"",a,Y,Z,this.Config)},setData:function(a,Z,Y){X.call(this,"",a,Z,Y)},setDataset:function(b,c){b=C.splat(b);for(var Y in c){for(var a=0,d=C.splat(c[Y]),Z=b.length;a<Z;a++){this.setData(Y,d[a],b[a])}}},removeData:function(){W.call(this,"",Array.prototype.slice.call(arguments))},getCanvasStyle:function(a,Y,Z){return V.call(this,"canvas",a,Y,Z,this.Config.CanvasStyles)},setCanvasStyle:function(a,Z,Y){X.call(this,"canvas",a,Z,Y)},setCanvasStyles:function(b,c){b=C.splat(b);for(var Y in c){for(var a=0,d=C.splat(c[Y]),Z=b.length;a<Z;a++){this.setCanvasStyle(Y,d[a],b[a])}}},removeCanvasStyle:function(){W.call(this,"canvas",Array.prototype.slice.call(arguments))},getLabelData:function(a,Y,Z){return V.call(this,"label",a,Y,Z,this.Label)},setLabelData:function(a,Z,Y){X.call(this,"label",a,Z,Y)},setLabelDataset:function(b,c){b=C.splat(b);for(var Y in c){for(var a=0,d=C.splat(c[Y]),Z=b.length;a<Z;a++){this.setLabelData(Y,d[a],b[a])}}},removeLabelData:function(){W.call(this,"label",Array.prototype.slice.call(arguments))}}})();E.Node=new Q({initialize:function(Y,V,X,W,a){var Z={id:"",name:"",data:{},startData:{},endData:{},adjacencies:{},selected:false,drawn:false,exist:false,angleSpan:{begin:0,end:0},pos:new V,startPos:new V,endPos:new V};C.extend(this,C.extend(Z,Y));this.Config=this.Node=X;this.Edge=W;this.Label=a},adjacentTo:function(V){return V.id in this.adjacencies},adjacentWithDirectionTo:function(V){var W=V.id in this.adjacencies;if(!W){return false}var X=this.adjacencies[V.id].data.$direction;return X[0]===this.id},getAdjacency:function(V){return this.adjacencies[V]},getPos:function(V){V=V||"current";if(V=="current"){return this.pos}else{if(V=="end"){return this.endPos}else{if(V=="start"){return this.startPos}}}},setPos:function(W,V){V=V||"current";var X;if(V=="current"){X=this.pos}else{if(V=="end"){X=this.endPos}else{if(V=="start"){X=this.startPos}}}X.set(W)}});E.Node.implement(J);E.Adjacence=new Q({initialize:function(W,Z,X,V,Y){this.nodeFrom=W;this.nodeTo=Z;this.data=X||{};this.startData={};this.endData={};this.Config=this.Edge=V;this.Label=Y}});E.Adjacence.implement(J);E.Util={filter:function(W){if(!W||!(C.type(W)=="string")){return function(){return true}}var V=W.split(" ");return function(Y){for(var X=0;X<V.length;X++){if(Y[V[X]]){return false}}return true}},getNode:function(V,W){return V.nodes[W]},eachNode:function(Z,Y,V){var X=this.filter(V);for(var W in Z.nodes){if(X(Z.nodes[W])){Y(Z.nodes[W])}}},each:function(X,W,V){this.eachNode(X,W,V)},eachAdjacency:function(b,c,W){var X=b.adjacencies,Z=this.filter(W);for(var d in X){var V=X[d];if(Z(V)){if(V.nodeFrom!=b){var Y=V.nodeFrom;V.nodeFrom=V.nodeTo;V.nodeTo=Y}c(V,d)}}},computeLevels:function(b,c,Y,X){Y=Y||0;var Z=this.filter(X);this.eachNode(b,function(d){d._flag=false;d._depth=-1},X);var W=b.getNode(c);W._depth=Y;var V=[W];while(V.length!=0){var a=V.pop();a._flag=true;this.eachAdjacency(a,function(d){var e=d.nodeTo;if(e._flag==false&&Z(e)&&!d._hiding){if(e._depth<0){e._depth=a._depth+1+Y}V.unshift(e)}},X)}},eachBFS:function(a,b,Z,W){var X=this.filter(W);this.clean(a);var V=[a.getNode(b)];while(V.length!=0){var Y=V.pop();if(!Y){return}Y._flag=true;Z(Y,Y._depth);this.eachAdjacency(Y,function(c){var d=c.nodeTo;if(d._flag==false&&X(d)&&!c._hiding){d._flag=true;V.unshift(d)}},W)}},eachLevel:function(Z,f,W,a,Y){var e=Z._depth,V=this.filter(Y),b=this,c=true;W=W===false?Number.MAX_VALUE-e:W;(function X(j,g,h){if(!c){return}var k=j._depth,i;if(k>=g&&k<=h&&V(j)){i=a(j,k)}if(typeof i!=="undefined"){c=i}if(c&&k<h){b.eachAdjacency(j,function(d){var l=d.nodeTo;if(l._depth>k){X(l,g,h)}})}})(Z,f+e,W+e)},eachSubgraph:function(W,X,V){this.eachLevel(W,0,false,X,V)},eachSubnode:function(W,X,V){this.eachLevel(W,1,1,X,V)},anySubnode:function(Y,X,W){var V=false;X=X||C.lambda(true);var Z=C.type(X)=="string"?function(a){return a[X]}:X;this.eachSubnode(Y,function(a){if(Z(a)){V=true}},W);return V},getSubnodes:function(a,b,V){var X=[],Z=this;b=b||0;var Y,W;if(C.type(b)=="array"){Y=b[0];W=b[1]}else{Y=b;W=Number.MAX_VALUE-a._depth}this.eachLevel(a,Y,W,function(c){X.push(c)},V);return X},getParents:function(W){var V=[];this.eachAdjacency(W,function(X){var Y=X.nodeTo;if(Y._depth<W._depth){V.push(Y)}});return V},isDescendantOf:function(Y,Z){if(Y.id==Z){return true}var X=this.getParents(Y),V=false;for(var W=0;!V&&W<X.length;W++){V=V||this.isDescendantOf(X[W],Z)}return V},clean:function(V){this.eachNode(V,function(W){W._flag=false})},getClosestNodeToOrigin:function(W,X,V){return this.getClosestNodeToPos(W,B.KER,X,V)},getClosestNodeToPos:function(X,a,Z,V){var W=null;Z=Z||"current";a=a&&a.getc(true)||P.KER;var Y=function(d,c){var f=d.x-c.x,e=d.y-c.y;return f*f+e*e};this.eachNode(X,function(b){W=(W==null||Y(b.getPos(Z).getc(true),a)<Y(W.getPos(Z).getc(true),a))?b:W},V);return W}};C.each(["get","getNode","each","eachNode","computeLevels","eachBFS","clean","getClosestNodeToPos","getClosestNodeToOrigin"],function(V){E.prototype[V]=function(){return E.Util[V].apply(E.Util,[this].concat(Array.prototype.slice.call(arguments)))}});C.each(["eachAdjacency","eachLevel","eachSubgraph","eachSubnode","anySubnode","getSubnodes","getParents","isDescendantOf"],function(V){E.Node.prototype[V]=function(){return E.Util[V].apply(E.Util,[this].concat(Array.prototype.slice.call(arguments)))}});E.Op={options:{type:"nothing",duration:2000,hideLabels:true,fps:30},initialize:function(V){this.viz=V},removeNode:function(a,Y){var V=this.viz;var W=C.merge(this.options,V.controller,Y);var c=C.splat(a);var X,Z,b;switch(W.type){case"nothing":for(X=0;X<c.length;X++){W.onBeforeRemoveNode(V.graph.getNode(c[X]));V.graph.removeNode(c[X])}break;case"replot":this.removeNode(c,{type:"nothing"});V.labels.clearLabels();V.refresh(true);break;case"fade:seq":case"fade":Z=this;for(X=0;X<c.length;X++){b=V.graph.getNode(c[X]);b.setData("alpha",0,"end")}V.fx.animate(C.merge(W,{modes:["node-property:alpha"],onComplete:function(){Z.removeNode(c,{type:"nothing"});V.labels.clearLabels();V.reposition();V.fx.animate(C.merge(W,{modes:["linear"]}))}}));break;case"fade:con":Z=this;for(X=0;X<c.length;X++){b=V.graph.getNode(c[X]);b.setData("alpha",0,"end");b.ignore=true}V.reposition();V.fx.animate(C.merge(W,{modes:["node-property:alpha","linear"],onComplete:function(){Z.removeNode(c,{type:"nothing"});W.onComplete&&W.onComplete()}}));break;case"iter":Z=this;V.fx.sequence({condition:function(){return c.length!=0},step:function(){Z.removeNode(c.shift(),{type:"nothing"});V.labels.clearLabels()},onComplete:function(){W.onComplete&&W.onComplete()},duration:Math.ceil(W.duration/c.length)});break;default:this.doError()}},removeEdge:function(c,a){var V=this.viz;var Y=C.merge(this.options,V.controller,a);var X=(C.type(c[0])=="string")?[c]:c;var Z,b,W;switch(Y.type){case"nothing":for(Z=0;Z<X.length;Z++){V.graph.removeAdjacence(X[Z][0],X[Z][1])}break;case"replot":this.removeEdge(X,{type:"nothing"});V.refresh(true);break;case"fade:seq":case"fade":b=this;for(Z=0;Z<X.length;Z++){W=V.graph.getAdjacence(X[Z][0],X[Z][1]);if(W){W.setData("alpha",0,"end")}}V.fx.animate(C.merge(Y,{modes:["edge-property:alpha"],onComplete:function(){b.removeEdge(X,{type:"nothing"});V.reposition();V.fx.animate(C.merge(Y,{modes:["linear"]}))}}));break;case"fade:con":b=this;for(Z=0;Z<X.length;Z++){W=V.graph.getAdjacence(X[Z][0],X[Z][1]);if(W){W.setData("alpha",0,"end");W.ignore=true}}V.reposition();V.fx.animate(C.merge(Y,{modes:["edge-property:alpha","linear"],onComplete:function(){b.removeEdge(X,{type:"nothing"});Y.onComplete&&Y.onComplete()}}));break;case"iter":b=this;V.fx.sequence({condition:function(){return X.length!=0},step:function(){b.removeEdge(X.shift(),{type:"nothing"});V.labels.clearLabels()},onComplete:function(){Y.onComplete()},duration:Math.ceil(Y.duration/X.length)});break;default:this.doError()}},sum:function(Z,Y){var V=this.viz;var X=C.merge(this.options,V.controller,Y),W=V.root;var b;V.root=Y.id||V.root;switch(X.type){case"nothing":b=V.construct(Z);b.eachNode(function(d){d.eachAdjacency(function(e){V.graph.addAdjacence(e.nodeFrom,e.nodeTo,e.data)})});break;case"replot":V.refresh(true);this.sum(Z,{type:"nothing"});V.refresh(true);break;case"fade:seq":case"fade":case"fade:con":that=this;b=V.construct(Z);var c=this.preprocessSum(b);var a=!c?["node-property:alpha"]:["node-property:alpha","edge-property:alpha"];V.reposition();if(X.type!="fade:con"){V.fx.animate(C.merge(X,{modes:["linear"],onComplete:function(){V.fx.animate(C.merge(X,{modes:a,onComplete:function(){X.onComplete()}}))}}))}else{V.graph.eachNode(function(d){if(d.id!=W&&d.pos.isZero()){d.pos.set(d.endPos);d.startPos.set(d.endPos)}});V.fx.animate(C.merge(X,{modes:["linear"].concat(a)}))}break;default:this.doError()}},morph:function(d,W,Y){Y=Y||{};var a=this.viz;var e=C.merge(this.options,a.controller,W),Z=a.root;var b;a.root=W.id||a.root;switch(e.type){case"nothing":b=a.construct(d);b.eachNode(function(h){var g=a.graph.hasNode(h.id);h.eachAdjacency(function(l){var k=!!a.graph.getAdjacence(l.nodeFrom.id,l.nodeTo.id);a.graph.addAdjacence(l.nodeFrom,l.nodeTo,l.data);if(k){var j=a.graph.getAdjacence(l.nodeFrom.id,l.nodeTo.id);for(var m in (l.data||{})){j.data[m]=l.data[m]}}});if(g){var f=a.graph.getNode(h.id);for(var i in (h.data||{})){f.data[i]=h.data[i]}}});a.graph.eachNode(function(f){f.eachAdjacency(function(g){if(!b.getAdjacence(g.nodeFrom.id,g.nodeTo.id)){a.graph.removeAdjacence(g.nodeFrom.id,g.nodeTo.id)}});if(!b.hasNode(f.id)){a.graph.removeNode(f.id)}});break;case"replot":a.labels.clearLabels(true);this.morph(d,{type:"nothing"});a.refresh(true);a.refresh(true);break;case"fade:seq":case"fade":case"fade:con":that=this;b=a.construct(d);var c=("node-property" in Y)&&C.map(C.splat(Y["node-property"]),function(f){return"$"+f});a.graph.eachNode(function(g){var h=b.getNode(g.id);if(!h){g.setData("alpha",1);g.setData("alpha",1,"start");g.setData("alpha",0,"end");g.ignore=true}else{var f=h.data;for(var i in f){if(c&&(C.indexOf(c,i)>-1)){g.endData[i]=f[i]}else{g.data[i]=f[i]}}}});a.graph.eachNode(function(f){if(f.ignore){return}f.eachAdjacency(function(g){if(g.nodeFrom.ignore||g.nodeTo.ignore){return}var h=b.getNode(g.nodeFrom.id);var i=b.getNode(g.nodeTo.id);if(!h.adjacentTo(i)){var g=a.graph.getAdjacence(h.id,i.id);V=true;g.setData("alpha",1);g.setData("alpha",1,"start");g.setData("alpha",0,"end");g._hiding=true}else{if(g.data.$direction&&g.data.$direction[0]===h.id){if(!h.adjacentWithDirectionTo(i)){g._reversing=true}}}})});var V=this.preprocessSum(b);var X=!V?["node-property:alpha"]:["node-property:alpha","edge-property:alpha"];X[0]=X[0]+(("node-property" in Y)?(":"+C.splat(Y["node-property"]).join(":")):"");X[1]=(X[1]||"edge-property:alpha")+(("edge-property" in Y)?(":"+C.splat(Y["edge-property"]).join(":")):"");if("label-property" in Y){X.push("label-property:"+C.splat(Y["label-property"]).join(":"))}if(a.reposition){a.reposition()}else{a.compute("end")}this._updateDirectedEdges();a.graph.eachNode(function(f){if(f.id!=Z&&f.pos.getp().equals(B.KER)){f.pos.set(f.endPos);f.startPos.set(f.endPos)}});a.fx.animate(C.merge(e,{modes:[Y.position||"polar"].concat(X),onComplete:function(){a.graph.eachNode(function(f){if(f.ignore){a.graph.removeNode(f.id)}});a.graph.eachNode(function(f){f.eachAdjacency(function(g){if(g.ignore){a.graph.removeAdjacence(g.nodeFrom.id,g.nodeTo.id)}})});e.onComplete()}}));break;default:}},_updateDirectedEdges:function(){var V=this.viz.graph;V.eachNode(function(W){W.eachAdjacency(function(Z){var a=Z.data.$direction;if(a&&Z.nodeFrom.id!==Z.data.$direction[0]){return}if(Z._hiding){V.removeAdjacence(Z.nodeFrom.id,Z.nodeTo.id)}if(Z._reversing){var c=Z.nodeFrom.id;var b=Z.nodeTo.id;var Y=V.edges[c][b];var X=V.edges[b][c];Y.data.$direction=[b,c];X.data.$direction=[b,c];Z._reversing=undefined}})})},contract:function(X,W){var V=this.viz;if(X.collapsed||!X.anySubnode(C.lambda(true))){return}W=C.merge(this.options,V.config,W||{},{modes:["node-property:alpha:span","linear"]});X.collapsed=true;(function Y(Z){Z.eachSubnode(function(a){a.ignore=true;a.setData("alpha",0,W.type=="animate"?"end":"current");Y(a)})})(X);if(W.type=="animate"){V.compute("end");if(V.rotated){V.rotate(V.rotated,"none",{property:"end"})}(function Y(Z){Z.eachSubnode(function(a){a.setPos(X.getPos("end"),"end");Y(a)})})(X);V.fx.animate(W)}else{if(W.type=="replot"){V.refresh()}}},expand:function(X,W){if(!("collapsed" in X)){return}var V=this.viz;W=C.merge(this.options,V.config,W||{},{modes:["node-property:alpha:span","linear"]});delete X.collapsed;(function Y(Z){Z.eachSubnode(function(a){delete a.ignore;a.setData("alpha",1,W.type=="animate"?"end":"current");Y(a)})})(X);if(W.type=="animate"){V.compute("end");if(V.rotated){V.rotate(V.rotated,"none",{property:"end"})}V.fx.animate(W)}else{if(W.type=="replot"){V.refresh()}}},preprocessSum:function(W){var V=this.viz;W.eachNode(function(Y){if(!V.graph.hasNode(Y.id)){V.graph.addNode(Y);var Z=V.graph.getNode(Y.id);Z.setData("alpha",0);Z.setData("alpha",0,"start");Z.setData("alpha",1,"end")}});var X=false;W.eachNode(function(Y){Y.eachAdjacency(function(Z){var a=V.graph.getNode(Z.nodeFrom.id);var b=V.graph.getNode(Z.nodeTo.id);if(!a.adjacentTo(b)){var Z=V.graph.addAdjacence(a,b,Z.data);if(a.startAlpha==a.endAlpha&&b.startAlpha==b.endAlpha){X=true;Z.setData("alpha",0);Z.setData("alpha",0,"start");Z.setData("alpha",1,"end")}}})});return X}};var A={none:{render:C.empty,contains:C.lambda(false)},circle:{render:function(Y,Z,V,X){var W=X.getCtx();W.beginPath();W.arc(Z.x,Z.y,V,0,Math.PI*2,true);W.closePath();W[Y]()},contains:function(a,Z,V){var X=a.x-Z.x,W=a.y-Z.y,Y=X*X+W*W;return Y<=V*V}},ellipse:{render:function(b,d,V,e,W){var f=W.getCtx(),Y=1,X=1,c=1,a=1,Z=0;if(V>e){Z=V/2;X=e/V;a=V/e}else{Z=e/2;Y=V/e;c=e/V}f.save();f.scale(Y,X);f.beginPath();f.arc(d.x*c,d.y*a,Z,0,Math.PI*2,true);f.closePath();f[b]();f.restore()},contains:function(V,c,W,e){var b=0,a=1,Z=1,Y=0,X=0,d=0;if(W>e){b=W/2;Z=e/W}else{b=e/2;a=W/e}Y=(V.x-c.x)*(1/a);X=(V.y-c.y)*(1/Z);d=Y*Y+X*X;return d<=b*b}},square:{render:function(W,Y,X,V){V.getCtx()[W+"Rect"](Y.x-X,Y.y-X,2*X,2*X)},contains:function(X,W,V){return Math.abs(W.x-X.x)<=V&&Math.abs(W.y-X.y)<=V}},rectangle:{render:function(Y,Z,X,V,W){W.getCtx()[Y+"Rect"](Z.x-X/2,Z.y-V/2,X,V)},contains:function(Y,X,W,V){return Math.abs(X.x-Y.x)<=W/2&&Math.abs(X.y-Y.y)<=V/2}},triangle:{render:function(b,c,Y,V){var f=V.getCtx(),X=c.x,W=c.y-Y,e=X-Y,d=c.y+Y,a=X+Y,Z=d;f.beginPath();f.moveTo(X,W);f.lineTo(e,d);f.lineTo(a,Z);f.closePath();f[b]()},contains:function(X,W,V){return A.circle.contains(X,W,V)}},star:{render:function(Z,b,a,W){var V=W.getCtx(),Y=Math.PI/5;V.save();V.translate(b.x,b.y);V.beginPath();V.moveTo(a,0);for(var X=0;X<9;X++){V.rotate(Y);if(X%2==0){V.lineTo((a/0.525731)*0.200811,0)}else{V.lineTo(a,0)}}V.closePath();V[Z]();V.restore()},contains:function(X,W,V){return A.circle.contains(X,W,V)}}};var M={line:{render:function(Y,X,W){var V=W.getCtx();V.beginPath();V.moveTo(Y.x,Y.y);V.lineTo(X.x,X.y);V.stroke()},contains:function(f,X,a,d){var Y=Math.min,b=Math.max,W=Y(f.x,X.x)-d,e=b(f.x,X.x)+d,V=Y(f.y,X.y)-d,c=b(f.y,X.y)+d;if(a.x>=W&&a.x<=e&&a.y>=V&&a.y<=c){if(Math.abs(X.x-f.x)<=d){return true}var Z=(X.y-f.y)/(X.x-f.x)*(a.x-f.x)+f.y;return Math.abs(Z-a.y)<=d}return false}},arrow:{render:function(h,i,Z,W,V,X){var j=V.getCtx();if(W){var Y=h;h=i;i=Y}var c=new P(i.x-h.x,i.y-h.y);c.$scale(Z/c.norm());var f;switch(X){case"end":f=c;break;case"center":f=new P((i.x-h.x)/2,(i.y-h.y)/2);break}var a=new P(i.x-f.x,i.y-f.y),b=new P(-c.y/2,c.x/2),d=a.add(c),g=a.add(b),e=a.$add(b.$scale(-1));j.beginPath();j.moveTo(h.x,h.y);j.lineTo(i.x,i.y);j.stroke();j.beginPath();j.moveTo(g.x,g.y);j.moveTo(g.x,g.y);j.lineTo(e.x,e.y);j.lineTo(d.x,d.y);j.closePath();j.fill()},contains:function(W,V,Y,X){return M.line.contains(W,V,Y,X)}},hyperline:{render:function(c,d,V,X){var e=X.getCtx();var Y=Z(c,d);if(Y.a>1000||Y.b>1000||Y.ratio<0){e.beginPath();e.moveTo(c.x*V,c.y*V);e.lineTo(d.x*V,d.y*V);e.stroke()}else{var b=Math.atan2(d.y-Y.y,d.x-Y.x);var a=Math.atan2(c.y-Y.y,c.x-Y.x);var W=W(b,a);e.beginPath();e.arc(Y.x*V,Y.y*V,Y.ratio*V,b,a,W);e.stroke()}function Z(r,q){var j=(r.x*q.y-r.y*q.x),f=j;var i=r.squaredNorm(),h=q.squaredNorm();if(j==0){return{x:0,y:0,ratio:-1}}var p=(r.y*h-q.y*i+r.y-q.y)/j;var n=(q.x*i-r.x*h+q.x-r.x)/f;var o=-p/2;var m=-n/2;var l=(p*p+n*n)/4-1;if(l<0){return{x:0,y:0,ratio:-1}}var k=Math.sqrt(l);var g={x:o,y:m,ratio:k>1000?-1:k,a:p,b:n};return g}function W(f,g){return(f<g)?((f+Math.PI>g)?false:true):((g+Math.PI>f)?true:false)}},contains:C.lambda(false)}};E.Plot={initialize:function(W,V){this.viz=W;this.config=W.config;this.node=W.config.Node;this.edge=W.config.Edge;this.animation=new U;this.nodeTypes=new V.Plot.NodeTypes;this.edgeTypes=new V.Plot.EdgeTypes;this.labels=W.labels},nodeHelper:A,edgeHelper:M,Interpolator:{map:{border:"color",color:"color",width:"number",height:"number",dim:"number",alpha:"number",lineWidth:"number",angularWidth:"number",span:"number",valueArray:"array-number",dimArray:"array-number",vertices:"polygon"},canvas:{globalAlpha:"number",fillStyle:"color",strokeStyle:"color",lineWidth:"number",shadowBlur:"number",shadowColor:"color",shadowOffsetX:"number",shadowOffsetY:"number",miterLimit:"number"},label:{size:"number",color:"color"},compute:function(X,W,V){return X+(W-X)*V},moebius:function(a,Z,c,W){var Y=W.scale(-c);if(Y.norm()<1){var V=Y.x,b=Y.y;var X=a.startPos.getc().moebiusTransformation(Y);a.pos.setc(X.x,X.y);Y.x=V;Y.y=b}},linear:function(W,V,Z){var Y=W.startPos.getc(true);var X=W.endPos.getc(true);W.pos.setc(this.compute(Y.x,X.x,Z),this.compute(Y.y,X.y,Z))},polar:function(X,W,a){var Z=X.startPos.getp(true);var Y=X.endPos.getp();var V=Y.interpolate(Z,a);X.pos.setp(V.theta,V.rho)},number:function(W,b,a,V,Z){var Y=W[V](b,"start");var X=W[V](b,"end");W[Z](b,this.compute(Y,X,a))},color:function(X,V,d,a,Y){var b=C.hexToRgb(X[a](V,"start"));var c=C.hexToRgb(X[a](V,"end"));var Z=this.compute;var W=C.rgbToHex([parseInt(Z(b[0],c[0],d)),parseInt(Z(b[1],c[1],d)),parseInt(Z(b[2],c[2],d))]);X[Y](V,W)},"array-number":function(Y,X,k,f,a){var g=Y[f](X,"start"),h=Y[f](X,"end"),m=[];for(var d=0,Z=g.length;d<Z;d++){var W=g[d],V=h[d];if(W.length){for(var c=0,e=W.length,b=[];c<e;c++){b.push(this.compute(W[c],V[c],k))}m.push(b)}else{m.push(this.compute(W,V,k))}}Y[a](X,m)},node:function(W,b,d,V,c,X){V=this[V];if(b){var a=b.length;for(var Y=0;Y<a;Y++){var Z=b[Y];this[V[Z]](W,Z,d,c,X)}}else{for(var Z in V){this[V[Z]](W,Z,d,c,X)}}},edge:function(X,W,c,Y,V,b){var a=X.adjacencies;for(var Z in a){this["node"](a[Z],W,c,Y,V,b)}},"node-property":function(W,V,X){this["node"](W,V,X,"map","getData","setData")},"edge-property":function(W,V,X){this["edge"](W,V,X,"map","getData","setData")},"label-property":function(W,V,X){this["node"](W,V,X,"label","getLabelData","setLabelData")},"node-style":function(W,V,X){this["node"](W,V,X,"canvas","getCanvasStyle","setCanvasStyle")},"edge-style":function(W,V,X){this["edge"](W,V,X,"canvas","getCanvasStyle","setCanvasStyle")},polygon:function(Y,X,k,f,a){var h=Y[f](X,"start"),j=Y[f](X,"end"),m=[];if(typeof h.offset=="undefined"){if(h===0){h=C.map(j,function(){return new $jit.Complex(0,0)});h.offset=0}else{if(h.length==0){h.push(new $jit.Complex(0,0))}while(h.length<j.length){h.push(h[0])}while(h.length>j.length){j.push(j[0]||new $jit.Complex(0,0))}if(h.length==0){return}var Z=h.length;var g=1e+300;for(var b=0;b<Z;b++){var e=0;for(var c=0;c<Z;c++){e+=Geometry.dist2(h[(b+c)%Z],j[c])}if(e<g){h.offset=b;g=e}}}}for(var c=0,Z=h.length;c<Z;c++){var W=h[(c+h.offset)%Z],V=j[c];m.push(new $jit.Complex(this.compute(W.x,V.x,k),this.compute(W.y,V.y,k)))}Y[a](X,m)}},sequence:function(W){var X=this;W=C.merge({condition:C.lambda(false),step:C.empty,onComplete:C.empty,duration:200},W||{});var V=setInterval(function(){if(W.condition()){W.step()}else{clearInterval(V);W.onComplete()}X.viz.refresh(true)},W.duration)},prepare:function(b){var a=this.viz.graph,Y={"node-property":{getter:"getData",setter:"setData"},"edge-property":{getter:"getData",setter:"setData"},"node-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"},"edge-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"}};var W={};if(C.type(b)=="array"){for(var Z=0,V=b.length;Z<V;Z++){var X=b[Z].split(":");W[X.shift()]=X}}else{for(var c in b){if(c=="position"){W[b.position]=[]}else{W[c]=C.splat(b[c])}}}a.eachNode(function(d){d.startPos.set(d.pos);C.each(["node-property","node-style"],function(g){if(g in W){var h=W[g];for(var f=0,e=h.length;f<e;f++){d[Y[g].setter](h[f],d[Y[g].getter](h[f]),"start")}}});C.each(["edge-property","edge-style"],function(e){if(e in W){var f=W[e];d.eachAdjacency(function(h){for(var j=0,g=f.length;j<g;j++){h[Y[e].setter](f[j],h[Y[e].getter](f[j]),"start")}})}})});return W},animate:function(Y,X){Y=C.merge(this.viz.config,Y||{});var Z=this,W=this.viz,b=W.graph,c=this.Interpolator,a=Y.type==="nodefx"?this.nodeFxAnimation:this.animation;var V=this.prepare(Y.modes);if(Y.hideLabels){this.labels.hideLabels(true)}a.setOptions(C.extend(Y,{$animating:false,compute:function(d){b.eachNode(function(e){for(var f in V){c[f](e,V[f],d,X)}});Z.plot(Y,this.$animating,d);this.$animating=true},complete:function(){if(Y.hideLabels){Z.labels.hideLabels(false)}Z.plot(Y);Y.onComplete()}})).start()},nodeFx:function(X){if(this.nodeFxAnimation==undefined){this.nodeFxAnimation=new U()}var c=this.viz,d=c.graph,a=this.nodeFxAnimation,e=C.merge(this.viz.config,{elements:{id:false,properties:{}},reposition:false});X=C.merge(e,X||{},{onBeforeCompute:C.empty,onAfterCompute:C.empty});a.stopTimer();var b=X.elements.properties;if(!X.elements.id){d.eachNode(function(g){for(var f in b){g.setData(f,b[f],"end")}})}else{var V=C.splat(X.elements.id);C.each(V,function(h){var g=d.getNode(h);if(g){for(var f in b){g.setData(f,b[f],"end")}}})}var Z=[];for(var W in b){Z.push(W)}var Y=["node-property:"+Z.join(":")];if(X.reposition){Y.push("linear");c.compute("end")}this.animate(C.merge(X,{modes:Y,type:"nodefx"}))},plot:function(W,f){var d=this.viz,a=d.graph,X=d.canvas,V=d.root,b=this,e=X.getCtx(),Z=Math.min,W=W||this.viz.controller;W.clearCanvas&&X.clear();var c=a.getNode(V);if(!c){return}var Y=!!c.visited;a.eachNode(function(h){var g=h.getData("alpha");h.eachAdjacency(function(i){var j=i.nodeTo;if(!!j.visited===Y&&h.drawn&&j.drawn){!f&&W.onBeforePlotLine(i);b.plotLine(i,X,f);!f&&W.onAfterPlotLine(i)}});if(h.drawn){!f&&W.onBeforePlotNode(h);b.plotNode(h,X,f);!f&&W.onAfterPlotNode(h)}if(!b.labelsHidden&&W.withLabels){if(h.drawn&&g>=0.95){b.labels.plotLabel(X,h,W)}else{b.labels.hideLabel(h,false)}}h.visited=!Y})},plotTree:function(Z,W,d){var a=this,b=this.viz,X=b.canvas,Y=this.config,c=X.getCtx();var V=Z.getData("alpha");Z.eachSubnode(function(f){if(W.plotSubtree(Z,f)&&f.exist&&f.drawn){var e=Z.getAdjacency(f.id);!d&&W.onBeforePlotLine(e);a.plotLine(e,X,d);!d&&W.onAfterPlotLine(e);a.plotTree(f,W,d)}});if(Z.drawn){!d&&W.onBeforePlotNode(Z);this.plotNode(Z,X,d);!d&&W.onAfterPlotNode(Z);if(!W.hideLabels&&W.withLabels&&V>=0.95){this.labels.plotLabel(X,Z,W)}else{this.labels.hideLabel(Z,false)}}else{this.labels.hideLabel(Z,true)}},plotNode:function(X,W,e){var b=X.getData("type"),a=this.node.CanvasStyles;if(b!="none"){var V=X.getData("lineWidth"),Z=X.getData("color"),Y=X.getData("alpha"),c=W.getCtx();c.save();c.lineWidth=V;c.fillStyle=c.strokeStyle=Z;c.globalAlpha=Y;for(var d in a){c[d]=X.getCanvasStyle(d)}this.nodeTypes[b].render.call(this,X,W,e);c.restore()}},plotLine:function(b,W,g){var a=b.getData("type"),Y=this.edge.CanvasStyles;if(a!="none"){var V=b.getData("lineWidth"),X=b.getData("color"),d=W.getCtx(),Z=b.nodeFrom,c=b.nodeTo;d.save();d.lineWidth=V;d.fillStyle=d.strokeStyle=X;d.globalAlpha=Math.min(Z.getData("alpha"),c.getData("alpha"),b.getData("alpha"));for(var e in Y){d[e]=b.getCanvasStyle(e)}this.edgeTypes[a].render.call(this,b,W,g);d.restore()}}};E.Plot3D=C.merge(E.Plot,{Interpolator:{linear:function(W,V,Z){var Y=W.startPos.getc(true);var X=W.endPos.getc(true);W.pos.setc(this.compute(Y.x,X.x,Z),this.compute(Y.y,X.y,Z),this.compute(Y.z,X.z,Z))}},plotNode:function(W,V){if(W.getData("type")=="none"){return}this.plotElement(W,V,{getAlpha:function(){return W.getData("alpha")}})},plotLine:function(V,W){if(V.getData("type")=="none"){return}this.plotElement(V,W,{getAlpha:function(){return Math.min(V.nodeFrom.getData("alpha"),V.nodeTo.getData("alpha"),V.getData("alpha"))}})},plotElement:function(z,d,Y){var w=d.getCtx(),e=new Matrix4,W=d.config.Scene.Lighting,AA=d.canvases[0],k=AA.program,y=AA.camera;if(!z.geometry){z.geometry=new O3D[z.getData("type")]}z.geometry.update(z);if(!z.webGLVertexBuffer){var j=[],a=[],q=[],o=0,t=z.geometry;for(var x=0,v=t.vertices,g=t.faces,f=g.length;x<f;x++){var m=g[x],c=v[m.a],b=v[m.b],Z=v[m.c],X=m.d?v[m.d]:false,s=m.normal;j.push(c.x,c.y,c.z);j.push(b.x,b.y,b.z);j.push(Z.x,Z.y,Z.z);if(X){j.push(X.x,X.y,X.z)}q.push(s.x,s.y,s.z);q.push(s.x,s.y,s.z);q.push(s.x,s.y,s.z);if(X){q.push(s.x,s.y,s.z)}a.push(o,o+1,o+2);if(X){a.push(o,o+2,o+3);o+=4}else{o+=3}}z.webGLVertexBuffer=w.createBuffer();w.bindBuffer(w.ARRAY_BUFFER,z.webGLVertexBuffer);w.bufferData(w.ARRAY_BUFFER,new Float32Array(j),w.STATIC_DRAW);z.webGLFaceBuffer=w.createBuffer();w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,z.webGLFaceBuffer);w.bufferData(w.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),w.STATIC_DRAW);z.webGLFaceCount=a.length;z.webGLNormalBuffer=w.createBuffer();w.bindBuffer(w.ARRAY_BUFFER,z.webGLNormalBuffer);w.bufferData(w.ARRAY_BUFFER,new Float32Array(q),w.STATIC_DRAW)}e.multiply(y.matrix,z.geometry.matrix);w.uniformMatrix4fv(k.viewMatrix,false,e.flatten());w.uniformMatrix4fv(k.projectionMatrix,false,y.projectionMatrix.flatten());var l=Matrix4.makeInvert(e);l.$transpose();w.uniformMatrix4fv(k.normalMatrix,false,l.flatten());var u=C.hexToRgb(z.getData("color"));u.push(Y.getAlpha());w.uniform4f(k.color,u[0]/255,u[1]/255,u[2]/255,u[3]);w.uniform1i(k.enableLighting,W.enable);if(W.enable){if(W.ambient){var p=W.ambient;w.uniform3f(k.ambientColor,p[0],p[1],p[2])}if(W.directional){var r=W.directional,u=r.color,h=r.direction,V=new Vector3(h.x,h.y,h.z).normalize().$scale(-1);w.uniform3f(k.lightingDirection,V.x,V.y,V.z);w.uniform3f(k.directionalColor,u[0],u[1],u[2])}}w.bindBuffer(w.ARRAY_BUFFER,z.webGLVertexBuffer);w.vertexAttribPointer(k.position,3,w.FLOAT,false,0,0);w.bindBuffer(w.ARRAY_BUFFER,z.webGLNormalBuffer);w.vertexAttribPointer(k.normal,3,w.FLOAT,false,0,0);w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,z.webGLFaceBuffer);w.drawElements(w.TRIANGLES,z.webGLFaceCount,w.UNSIGNED_SHORT,0)}});E.Label={};E.Label.Native=new Q({initialize:function(V){this.viz=V},plotLabel:function(X,Y,W){var V=X.getCtx();var Z=Y.pos.getc(true);V.font=Y.getLabelData("style")+" "+Y.getLabelData("size")+"px "+Y.getLabelData("family");V.textAlign=Y.getLabelData("textAlign");V.fillStyle=V.strokeStyle=Y.getLabelData("color");V.textBaseline=Y.getLabelData("textBaseline");this.renderLabel(X,Y,W)},renderLabel:function(X,Y,W){var V=X.getCtx();var Z=Y.pos.getc(true);V.fillText(Y.name,Z.x,Z.y+Y.getData("height")/2)},hideLabel:function(W,V){W=C.splat(W);var X=V?false:true;C.each(W,function(Y){Y._hideLabel=X})},hideLabels:C.empty});E.Label.DOM=new Q({labelsHidden:false,labelContainer:false,labels:{},getLabelContainer:function(){return this.labelContainer?this.labelContainer:this.labelContainer=document.getElementById(this.viz.config.labelContainer)},getLabel:function(V){return(V in this.labels&&this.labels[V]!=null)?this.labels[V]:this.labels[V]=document.getElementById(V)},hideLabels:function(W){var V=this.getLabelContainer();if(W){V.style.display="none"}else{V.style.display=""}this.labelsHidden=W},clearLabels:function(V){for(var W in this.labels){if(V||!this.viz.graph.hasNode(W)){this.disposeLabel(W);delete this.labels[W]}}},disposeLabel:function(W){var V=this.getLabel(W);if(V&&V.parentNode){V.parentNode.removeChild(V)}},hideLabel:function(Z,V){Z=C.splat(Z);var W=V?"":"none",X,Y=this;C.each(Z,function(a){X=Y.getLabel(a.id);if(X){X.style.display=W}})},fitsInCanvas:function(X,V){var W=V.getSize();if(X.w&&X.h){if(X.x>=W.width||X.x<-X.w||X.y>=W.height||X.y<-X.h){return false}}else{if(X.x>=W.width||X.x<0||X.y>=W.height||X.y<0){return false}}return true}});E.Label.HTML=new Q({Implements:E.Label.DOM,plotLabel:function(Y,Z,X){var a=Z.id,V=this.getLabel(a);if(!V&&!(V=document.getElementById(a))){V=document.createElement("div");var W=this.getLabelContainer();V.id=a;V.className="node";V.style.position="absolute";X.onCreateLabel(V,Z);W.appendChild(V);this.labels[Z.id]=V}this.placeLabel(V,Z,X)}});E.Label.SVG=new Q({Implements:E.Label.DOM,plotLabel:function(Y,a,X){var c=a.id,V=this.getLabel(c);if(!V&&!(V=document.getElementById(c))){var Z="http://www.w3.org/2000/svg";V=document.createElementNS(Z,"svg:text");var b=document.createElementNS(Z,"svg:tspan");V.appendChild(b);var W=this.getLabelContainer();V.setAttribute("id",c);V.setAttribute("class","node");W.appendChild(V);X.onCreateLabel(V,a);this.labels[a.id]=V}this.placeLabel(V,a,X)}});var D={construct:function(W){var X=(C.type(W)=="array");var V=new E(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);if(!X){(function(Y,a){Y.addNode(a);if(a.children){for(var Z=0,b=a.children;Z<b.length;Z++){Y.addAdjacence(a,b[Z]);arguments.callee(Y,b[Z])}}})(V,W)}else{(function(g,h){var Z=function(n){for(var m=0,j=h.length;m<j;m++){if(h[m].id==n){return h[m]}}var k={id:n,name:n};return g.addNode(k)};for(var d=0,a=h.length;d<a;d++){g.addNode(h[d]);var e=h[d].adjacencies;if(e){for(var b=0,f=e.length;b<f;b++){var Y=e[b],c={};if(typeof e[b]!="string"){c=C.merge(Y.data,{});Y=Y.nodeTo}g.addAdjacence(h[d],Z(Y),c)}}}})(V,W)}return V},loadJSON:function(W,V){this.json=W;if(this.labels&&this.labels.clearLabels){this.labels.clearLabels(true)}this.graph=this.construct(W);if(C.type(W)!="array"){this.root=W.id}else{this.root=W[V?V:0].id}},toJSON:function(Z){Z=Z||"tree";if(Z=="tree"){var X={};var W=this.graph.getNode(this.root);var X=(function V(c){var a={};a.id=c.id;a.name=c.name;a.data=c.data;var b=[];c.eachSubnode(function(d){b.push(V(d))});a.children=b;return a})(W);return X}else{var X=[];var Y=!!this.graph.getNode(this.root).visited;this.graph.eachNode(function(b){var a={};a.id=b.id;a.name=b.name;a.data=b.data;var c=[];b.eachAdjacency(function(d){var f=d.nodeTo;if(!!f.visited===Y){var e={};e.nodeTo=f.id;e.data=d.data;c.push(e)}});a.adjacencies=c;X.push(a);b.visited=!Y});return X}}};var G=$jit.Layouts={};var F={label:null,compute:function(Y,Z,W){this.initializeLabel(W);var V=this.label,X=V.style;Y.eachNode(function(c){var g=c.getData("autoWidth"),h=c.getData("autoHeight");if(g||h){delete c.data.$width;delete c.data.$height;delete c.data.$dim;var a=c.getData("width"),i=c.getData("height");X.width=g?"auto":a+"px";X.height=h?"auto":i+"px";V.innerHTML=c.name;var e=V.offsetWidth,b=V.offsetHeight;var f=c.getData("type");if(C.indexOf(["circle","square","triangle","star"],f)===-1){c.setData("width",e);c.setData("height",b)}else{var d=e>b?e:b;c.setData("width",d);c.setData("height",d);c.setData("dim",d)}}})},initializeLabel:function(V){if(!this.label){this.label=document.createElement("div");document.body.appendChild(this.label)}this.setLabelStyles(V)},setLabelStyles:function(V){C.extend(this.label.style,{visibility:"hidden",position:"absolute",width:"auto",height:"auto"});this.label.className="jit-autoadjust-label"}};G.Radial=new Q({compute:function(W){var X=C.splat(W||["current","start","end"]);F.compute(this.graph,X,this.config);this.graph.computeLevels(this.root,0,"ignore");var V=this.createLevelDistanceFunc();this.computeAngularWidths(X);this.computePositions(X,V)},computePositions:function(c,Z){var e=c;var d=this.graph;var a=d.getNode(this.root);var b=this.parent;var V=this.config;for(var X=0,W=e.length;X<W;X++){var Y=e[X];a.setPos(K(0,0),Y);a.setData("span",Math.PI*2,Y)}a.angleSpan={begin:0,end:2*Math.PI};d.eachBFS(this.root,function(m){var s=m.angleSpan.end-m.angleSpan.begin;var u=m.angleSpan.begin;var t=Z(m);var v=0,f=[],j={};m.eachSubnode(function(x){v+=x._treeAngularWidth;for(var y=0,k=e.length;y<k;y++){var AA=e[y],z=x.getData("dim",AA);j[AA]=(AA in j)?(z>j[AA]?z:j[AA]):z}f.push(x)},"ignore");if(b&&b.id==m.id&&f.length>0&&f[0].dist){f.sort(function(k,i){return(k.dist>=i.dist)-(k.dist<=i.dist)})}for(var o=0,q=f.length;o<q;o++){var h=f[o];if(!h._flag){var w=h._treeAngularWidth/v*s;var g=u+w/2;for(var p=0,n=e.length;p<n;p++){var r=e[p];h.setPos(K(g,t),r);h.setData("span",w,r);h.setData("dim-quotient",h.getData("dim",r)/j[r],r)}h.angleSpan={begin:u,end:u+w};u+=w}}},"ignore")},setAngularWidthForNodes:function(V){this.graph.eachBFS(this.root,function(Y,W){var X=Y.getData("angularWidth",V[0])||5;Y._angularWidth=X/W},"ignore")},setSubtreesAngularWidth:function(){var V=this;this.graph.eachNode(function(W){V.setSubtreeAngularWidth(W)},"ignore")},setSubtreeAngularWidth:function(Y){var X=this,W=Y._angularWidth,V=0;Y.eachSubnode(function(Z){X.setSubtreeAngularWidth(Z);V+=Z._treeAngularWidth},"ignore");Y._treeAngularWidth=Math.max(W,V)},computeAngularWidths:function(V){this.setAngularWidthForNodes(V);this.setSubtreesAngularWidth()}});P.prototype.moebiusTransformation=function(X){var V=this.add(X);var W=X.$conjugate().$prod(this);W.x++;return V.$div(W)};E.Util.moebiusTransformation=function(X,Z,Y,W,V){this.eachNode(X,function(b){for(var a=0;a<Y.length;a++){var d=Z[a].scale(-1),c=W?W:Y[a];b.getPos(Y[a]).set(b.getPos(c).getc().moebiusTransformation(d))}},V)};$jit.Hypertree=new Q({Implements:[D,O,G.Radial],initialize:function(V){var Y=$jit.Hypertree;var W={radius:"auto",offset:0,Edge:{type:"hyperline"},duration:1500,fps:35};this.controller=this.config=C.merge(N("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),W,V);var X=this.config;if(X.useCanvas){this.canvas=X.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(X.background){X.background=C.merge({type:"Circles"},X.background)}this.canvas=new L(this,X);this.config.labelContainer=(typeof X.injectInto=="string"?X.injectInto:X.injectInto.id)+"-label"}this.graphOptions={klass:B,Node:{selected:false,exist:true,drawn:true}};this.graph=new E(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new Y.Label[X.Label.type](this);this.fx=new Y.Plot(this,Y);this.op=new Y.Op(this);this.json=null;this.root=null;this.busy=false;this.initializeExtras()},createLevelDistanceFunc:function(){var Z=this.getRadius();var b=0,V=Math.max,W=this.config;this.graph.eachNode(function(c){b=V(c._depth,b)},"ignore");b++;var a=function(c){return function(f){f.scale=Z;var h=f._depth+1;var g=0,e=Math.pow;while(h){g+=e(c,h--)}return g-W.offset}};for(var Y=0.51;Y<=1;Y+=0.01){var X=(1-Math.pow(Y,b))/(1-Y);if(X>=2){return a(Y-0.01)}}return a(0.75)},getRadius:function(){var V=this.config.radius;if(V!=="auto"){return V}var W=this.canvas.getSize();return Math.min(W.width,W.height)/2},refresh:function(V){if(V){this.reposition();this.graph.eachNode(function(W){W.startPos.rho=W.pos.rho=W.endPos.rho;W.startPos.theta=W.pos.theta=W.endPos.theta})}else{this.compute()}this.plot()},reposition:function(){this.compute("end");var V=this.graph.getNode(this.root).pos.getc().scale(-1);E.Util.moebiusTransformation(this.graph,[V],["end"],"end","ignore");this.graph.eachNode(function(W){if(W.ignore){W.endPos.rho=W.pos.rho;W.endPos.theta=W.pos.theta}})},plot:function(){this.fx.plot()},onClick:function(X,V){var W=this.graph.getNode(X).pos.getc(true);this.move(W,V)},move:function(Z,X){var W=R(Z.x,Z.y);if(this.busy===false&&W.norm()<1){this.busy=true;var V=this.graph.getClosestNodeToPos(W),Y=this;this.graph.computeLevels(V.id,0);this.controller.onBeforeCompute(V);X=C.merge({onComplete:C.empty},X||{});this.fx.animate(C.merge({modes:["moebius"],hideLabels:true},X,{onComplete:function(){Y.busy=false;X.onComplete()}}),W)}}});$jit.Hypertree.$extend=true;(function(V){V.Op=new Q({Implements:E.Op});V.Plot=new Q({Implements:E.Plot});V.Label={};V.Label.Native=new Q({Implements:E.Label.Native,initialize:function(W){this.viz=W},renderLabel:function(Y,a,X){var W=Y.getCtx();var b=a.pos.getc(true);var Z=this.viz.getRadius();W.fillText(a.name,b.x*Z,b.y*Z)}});V.Label.SVG=new Q({Implements:E.Label.SVG,initialize:function(W){this.viz=W},placeLabel:function(h,b,c){var f=b.pos.getc(true),Y=this.viz.canvas,Z=Y.translateOffsetX,X=Y.translateOffsetY,g=Y.scaleOffsetX,e=Y.scaleOffsetY,d=Y.getSize(),W=this.viz.getRadius();var a={x:Math.round((f.x*g)*W+Z+d.width/2),y:Math.round((f.y*e)*W+X+d.height/2)};h.setAttribute("x",a.x);h.setAttribute("y",a.y);c.onPlaceLabel(h,b)}});V.Label.HTML=new Q({Implements:E.Label.HTML,initialize:function(W){this.viz=W},placeLabel:function(i,c,d){var g=c.pos.getc(true),Z=this.viz.canvas,a=Z.translateOffsetX,Y=Z.translateOffsetY,h=Z.scaleOffsetX,f=Z.scaleOffsetY,e=Z.getSize(),W=this.viz.getRadius();var b={x:Math.round((g.x*h)*W+a+e.width/2),y:Math.round((g.y*f)*W+Y+e.height/2)};var X=i.style;X.left=b.x+"px";X.top=b.y+"px";X.display=this.fitsInCanvas(b,Z)?"":"none";d.onPlaceLabel(i,c)}});V.Plot.NodeTypes=new Q({none:{render:C.empty,contains:C.lambda(false)},circle:{render:function(Y,W){var X=this.node,a=Y.getData("dim"),Z=Y.pos.getc();a=X.transform?a*(1-Z.squaredNorm()):a;Z.$scale(Y.scale);if(a>0.2){this.nodeHelper.circle.render("fill",Z,a,W)}},contains:function(W,Z){var X=W.getData("dim"),Y=W.pos.getc().$scale(W.scale);return this.nodeHelper.circle.contains(Y,Z,X)}},ellipse:{render:function(Z,X){var a=Z.pos.getc().$scale(Z.scale),Y=Z.getData("width"),W=Z.getData("height");this.nodeHelper.ellipse.render("fill",a,Y,W,X)},contains:function(Y,a){var X=Y.getData("width"),W=Y.getData("height"),Z=Y.pos.getc().$scale(Y.scale);return this.nodeHelper.circle.contains(Z,a,X,W)}},square:{render:function(Y,W){var X=this.node,a=Y.getData("dim"),Z=Y.pos.getc();a=X.transform?a*(1-Z.squaredNorm()):a;Z.$scale(Y.scale);if(a>0.2){this.nodeHelper.square.render("fill",Z,a,W)}},contains:function(W,Z){var X=W.getData("dim"),Y=W.pos.getc().$scale(W.scale);return this.nodeHelper.square.contains(Y,Z,X)}},rectangle:{render:function(a,X){var Z=this.node,Y=a.getData("width"),W=a.getData("height"),b=a.pos.getc();Y=Z.transform?Y*(1-b.squaredNorm()):Y;W=Z.transform?W*(1-b.squaredNorm()):W;b.$scale(a.scale);if(Y>0.2&&W>0.2){this.nodeHelper.rectangle.render("fill",b,Y,W,X)}},contains:function(Y,a){var X=Y.getData("width"),W=Y.getData("height"),Z=Y.pos.getc().$scale(Y.scale);return this.nodeHelper.rectangle.contains(Z,a,X,W)}},triangle:{render:function(Y,W){var X=this.node,a=Y.getData("dim"),Z=Y.pos.getc();a=X.transform?a*(1-Z.squaredNorm()):a;Z.$scale(Y.scale);if(a>0.2){this.nodeHelper.triangle.render("fill",Z,a,W)}},contains:function(W,Z){var X=W.getData("dim"),Y=W.pos.getc().$scale(W.scale);return this.nodeHelper.triangle.contains(Y,Z,X)}},star:{render:function(Y,W){var X=this.node,a=Y.getData("dim"),Z=Y.pos.getc();a=X.transform?a*(1-Z.squaredNorm()):a;Z.$scale(Y.scale);if(a>0.2){this.nodeHelper.star.render("fill",Z,a,W)}},contains:function(W,Z){var X=W.getData("dim"),Y=W.pos.getc().$scale(W.scale);return this.nodeHelper.star.contains(Y,Z,X)}}});V.Plot.EdgeTypes=new Q({none:C.empty,line:{render:function(W,X){var a=W.nodeFrom.pos.getc(true),Z=W.nodeTo.pos.getc(true),Y=W.nodeFrom.scale;this.edgeHelper.line.render({x:a.x*Y,y:a.y*Y},{x:Z.x*Y,y:Z.y*Y},X)},contains:function(W,a){var Z=W.nodeFrom.pos.getc(true),Y=W.nodeTo.pos.getc(true),X=W.nodeFrom.scale;this.edgeHelper.line.contains({x:Z.x*X,y:Z.y*X},{x:Y.x*X,y:Y.y*X},a,this.edge.epsilon)}},arrow:{render:function(X,Y){var d=X.nodeFrom.pos.getc(true),c=X.nodeTo.pos.getc(true),Z=X.nodeFrom.scale,b=X.getData("dim"),a=X.data.$direction,W=(a&&a.length>1&&a[0]!=X.nodeFrom.id);this.edgeHelper.arrow.render({x:d.x*Z,y:d.y*Z},{x:c.x*Z,y:c.y*Z},b,W,Y)},contains:function(W,a){var Z=W.nodeFrom.pos.getc(true),Y=W.nodeTo.pos.getc(true),X=W.nodeFrom.scale;this.edgeHelper.arrow.contains({x:Z.x*X,y:Z.y*X},{x:Y.x*X,y:Y.y*X},a,this.edge.epsilon)}},hyperline:{render:function(W,X){var a=W.nodeFrom.pos.getc(),Z=W.nodeTo.pos.getc(),Y=this.viz.getRadius();this.edgeHelper.hyperline.render(a,Z,Y,X)},contains:C.lambda(false)}})})($jit.Hypertree)})();